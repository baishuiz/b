!function(a){function b(a){this.target=a}var c=a.beacon,d=function(c){return this!==a&&d.blend(this,d),new b(c)};d.toString=function(){return"baishuiz@gmail.com"};var e={base:f,avatarCore:b.prototype,self:f,init:function(){var b=Object.freeze;a.beacon=d,e.merge(d,f),delete a.beacon.base,b&&b(d)},login:function(){a.beacon=d},logoff:function(){a.beacon=c}},f={base:e};a.beacon=f}(this),function(a){var b=a.base||{},c={merge:function(a){for(var b=arguments.length,c=0;b>c;c++){var d=arguments[c];for(var e in d)a[e]=d[e]}return a},blend:function(a,b,d){var e={cover:!0,mergePrototype:!1};d=d?c.merge(e,d):e,b=[].concat(b);for(var f=b.length,g=0;f>g;g++){var h=b[g];for(var i in h){var j=d.mergePrototype||h.hasOwnProperty(i),k=d.cover||!a[i];j&&k&&(a[i]=h[i])}}return a},isType:function(a,b){return"Null"===b&&null===a||"Undefined"===b&&void 0===a||"Number"===b&&isFinite(a)||Object.prototype.toString.call(a).slice(8,-1)===b},arrayIndexOf:function(a,b){return c.arrayIndexOf=Array.prototype.indexOf?function(a,b){return a=[].slice.call(a,0),a.indexOf(b)}:function(a,b){a=[].slice.call(a,0);for(var c=a.length;c>=0;c--)if(a[c]===b)return c;return c},c.arrayIndexOf(a,b)},each:function(a,b){if(a){a=[].concat(a);for(var c=0;c<a.length;c++)b.call(a[c],c,a[c])}}};c.blend(b,c)}(beacon),function(a){var b=a.base,c=function(a){function c(a){var b=e(f,a);0>b&&(b=f.push(a)-1);var c="event_"+b,d=a.toString()===a,g=d?a:c;return g}function d(a){var b=e(f,a);return 0>b?null:c(a)}var e=b.arrayIndexOf,f=[],g={dom:a,target:a,attachEvent:function(a,b){var d=c(a);f[d]=f[d]||[],f[d].push(b)},removeEvent:function(a,b){var d,e=a&&c(a),g=e&&f[e];if(a&&b)for(var h=g.length-1;h>=0;h--){var i=g[h];i===b&&(d=f[e].splice(h,1))}else a&&!b?(d=f[e],f[e]=[]):a||b||(d=f,f=[]);return d},getEventList:function(a){var b;if(!a)return f.slice(0);var c=d(a);return c&&(b=a?f[c]:f.slice(0)),b}};return g};b.EventStructure=c}(beacon),function(a){function b(a){var b=new j(a);return h.push(b),b}function c(a,c,d){var e=g(a)||b(a);e.attachEvent(c,d)}function d(a,b,d){var e=b.registEvent(d),f=b.getEventList();i.each(f,function(b){c(a,f[b],e)})}function e(a,b,c){var d=h.slice(0),e=a?g(a)||[]:h.slice(0);i.each(e,function(a,e){if(e.removeEvent(b,c),!b&&!c||0==e.getEventList().length){var a=i.arrayIndexOf(h,e);d.splice(a,1)}}),h=d}function f(a,b,c){var d=b.removeEvent(c);i.each(d,function(c){var f=d[c],g=b.getEventList();i.each(g,function(b,c){e(a,c,f)})})}function g(a){if(!a)return h.slice(0);for(var b=0;b<h.length;b++){var c=h[b];if(c.target===a)return c}}var h=[],i=a.base,j=i.EventStructure,k={registEvent:c,registCombinationEvent:d,removeEvent:e,removeCombinationEvent:f,getEventList:g};i.eventStore=k}(beacon),function(a){function b(){if(this instanceof b)return this;var a=[],d=[],e=[].slice.call(arguments,0),f=e.slice(0),g=function(){function b(){return f=e.slice(0)}var g=function(b,e){var f=c.arrayIndexOf(a,b);0>f&&(a.push(b),d.push(e))},h=function(b){var e=c.arrayIndexOf(a,b),f=d[e];return b?f:d.slice(0)};this.resetEventList=b,this.getEventList=function(){return e.slice(0)},this.registEvent=function(a){var d=c.arrayIndexOf,f=e.slice(0),h=function(c,e){var g=this,h=d(f,c.eventType);h>=0&&f.splice(h,1),0===f.length&&(a.call(g,e),f=b())};return g(a,h),h},this.removeEvent=function(a){var b=[].concat(h(a));return b}};return g.prototype=new b,new g}var c=a.base;c.combinationalEvent=b}(beacon),function(a){var b=a.base,c=b.eventStore,d=c.registCombinationEvent,e=c.registEvent,f=c.removeCombinationEvent,g=c.removeEvent,h=c.getEventList,i={hostProxy:{},attachActionEvent:function(a,c,d){var e=a.desc,f=b.isType(a.desc,"Function");f&&e(c,d);var g=["touchmove","mousemove"];b.each(g,function(b,c){f&&window.beacon(document).on(c,function(b){i.publicDispatchEvent(a,b)})})},attachEvent:function(a,c){var f=this,g=a instanceof b.combinationalEvent?d:e;i.attachActionEvent(a,f,c),g(f,a,c)},fireEvent:function(a,c){var d=this,e=h(d);if(e){var f=e.getEventList(a),g=b.isType(a.desc,"Function"),i=g&&a.desc(c);!!i==!!g&&b.each(f,function(b,e){var f={eventType:a};e.call(d,f,c)})}},publicDispatchEvent:function(a,c){var d=h(),e=b.isType(a.desc,"Function");e&&a.desc(c),b.each(d,function(b){var e=d[b].dom;i.fireEvent.call(e,a,c)})},removeEvent:function(a,c){var d=this,e=a instanceof b.combinationalEvent?f:g;e(d,a,c)}},j=function(){var a=function(){};return a.prototype=i,b.blend(a,i),a}();b.Event=j}(beacon),function(a){var b=a.base,c=function(){return this}(),d=b.EventStructure,e={structures:[],getStructure:function(a){for(var b,c,d=0;d<e.structures.length;d++){b=e.structures[d];try{c=b.dom===a}catch(f){b.dom=window.document,c=b.dom===a}if(c)return b}},add:function(a,b,c){var f=e.getStructure(a);f||(f=new d(a),e.structures.push(f)),f.attachEvent(b,c)},remove:function(a,b,c){var d=e.getStructure(a);return d&&d.removeEvent(b,c)}},f={attachEvent:function(a,b){var d,e=this,g=function(a,b){var c=this;c.addEventListener(a,b,!1)},h=function(a,b){var c=this;c.attachEvent("on"+a,b)},i=function(a,b){var c=this,d=c["on"+a];c["on"+a]=function(){d.call(c),b.call(c)}};return c.addEventListener?(g.call(e,a,b),d=g):c.attachEvent?(h.call(e,a,b),d=h):(i.call(e,a,b),d=i),f.attachEvent=d},fireEvent:function(a,b){var c,d=this,e=function(a,b){var c=this;b=b||{bubbles:!0,cancelable:!0},b.ieHack=c.all&&c.all.toString(),b.ieHack=c.style;var d=document.createEvent("Event");d.initEvent(a,b.bubbles,b.cancelable),b.state&&(d.state=b.state),c.dispatchEvent(d)},f=function(a,b){var c=this;b=b||{bubbles:!0,cancelable:!0},b.ieHack=c.all&&c.all.toString(),b.ieHack=c.style,a="on"+a;var d=document.createEventObject();d.cancelBubble=b.cancelable,c.fireEvent(a,d)};return document.createEvent&&d.dispatchEvent?(e.call(d,a,b),c=e):document.createEventObject&&d.fireEvent&&(f.call(d,a,b),c=f),c},removeEvent:function(a,b){var c,d=this,e=function(a,b){var c=this;c.removeEventListener(a,b,!1)},g=function(a,b){var c=this;c.detachEvent("on"+a,b)};return d.removeEventListener?(e.call(d,a,b),c=e):d.detachEvent&&(g.call(d,a,b),c=g),f.removeEvent=c}},g={attachEvent:function(a,b){var c=this;e.add(c,a,b),f.attachEvent.call(c,a,b)},fireEvent:function(a,b){var c=this;g.fireEVent=f.fireEvent.call(c,a,b)},removeEvent:function(a,c){var d=this;if(a&&c)f.removeEvent.call(d,a,c);else if(a&&!c){var h=e.remove(d,a);h&&b.each(h,function(){var b=this;g.removeEvent.call(d,a,b)})}else if(!a&&!c){var i=e.remove(d);i&&b.each(i,function(){var a=this;a&&b.each(i[a],function(){var b=this;g.removeEvent.call(d,a,b)})})}},isHTMLElement:function(a){var b=a==document||a==window,c=function(a){var b=a&&a.nodeName;return b&&a.nodeType};return b||c(a)},isEventSupported:function(a,c){if(!g.isHTMLElement(a)||!b.isType(c,"String"))return!1;var d=!1;if(a===window||a===document){d="on"+c in a;var e=!!window.ActiveXObject,f=e&&!!document.documentMode;if(!d&&f)return!1;if(d)return!0;var h=document.createElement("iframe");h.style.display="none",document.body.appendChild(h);var i=a===window?h.contentWindow:h.contentDocument;g.attachEvent.call(i,c,function(){d=!0}),g.fireEvent.call(i,c),h.parentNode.removeChild(h)}else{var j=a.tagName,c="on"+c;a=document.createElement(j),d=c in a,d||(a.setAttribute(c,"return;"),d="function"==typeof a[c]),a=null}return d}};b.DOMEvent=g}(beacon),function(a){var b=a.base,c={on:function(){var b=a.base,c=b.isType,d=b.Event.hostProxy,e=b.Event.publicDispatchEvent,f=b.Event.attachEvent,g=function(a,b){var g=[].slice.call(arguments,0);b&&c(b,"Function")?f.apply(d,g):e.apply(d,g)};return g}(a),once:function(a,b){var d=function(e,f){c.off(a,d),b.call({},e,f)};c.on(a,d)},off:function(){var b=a.base,c=b.Event.hostProxy,d=function(){var a=[].slice.call(arguments,0);b.Event.removeEvent.apply(c,a)};return d}(),blend:b.blend,NS:b.NS,arrayIndexOf:b.ArrayIndexOf,isType:b.isType,Enum:b.Enum,loginGlobal:b.login,logoffGlobal:b.logoff,utility:b,createEvent:function(){var a,c=[].slice.call(arguments,0);return a=arguments.length>1?b.combinationalEvent.apply(this,c):{desc:c[0]}}},d={on:function(b,c){var d=[].slice.call(arguments,0),e=this.target,f=a.base,g=f.DOMEvent.isHTMLElement(e),h=f.DOMEvent.isEventSupported(e,b),i=g&&h?f.DOMEvent.fireEvent:f.Event.fireEvent,j=g&&h?f.DOMEvent.attachEvent:f.Event.attachEvent;c&&f.isType(c,"Function")?f.each(e,function(a,b){j.apply(b,d)}):f.each(e,function(a,b){i.apply(b,d)})},once:function(a,b){var c=this,e=function(f,g){d.off.call(c,a,e),b.call(c,f,g)};d.on.call(c,a,e)},off:function(a,c,d){var e=this.target,f=b.DOMEvent.isHTMLElement(e),g=a&&b.DOMEvent.isEventSupported(e,a);f&&g?b.DOMEvent.removeEvent:b.Event.removeEvent,b.each(e,function(e,g){var h=a&&b.DOMEvent.isEventSupported(g,a);f&&b.DOMEvent.removeEvent.call(g,a,c,d),h||b.Event.removeEvent.call(g,a,c,d)})}};b.blend(b.avatarCore,d),b.blend(a,c),b.init()}(beacon),function(a){function b(a){this.target=a}var c=function(a){return new b(a)};c.toString=function(){return"baishuiz@gmail.com"};var d=document.getElementsByTagName("script"),e=d[d.length-1],f={avatarCore:b.prototype,plugins:{},attach:function(a,b){f.plugins[a]=b},baseURL:e.src.replace(/\/[^\/]+$/,"/"),CDNTimestamp:e.getAttribute("data-CDNTimestamp")||"",isDebug:!1,init:function(b){a.Air=f.plugins.merge(c,b)}},g={base:f};a.Air=g}(this),function(a){var b={NS:function(a,b){for(var c=a.split("."),d=b||window||{},b=d,e=0,f=c.length;f>e;e++)d[c[e]]=void 0===d[c[e]]?{}:d[c[e]],d=d[c[e]];return d},beacon:beacon,merge:beacon.utility.merge,setBaseURL:function(b){return a.base.baseURL=b||a.base.baseURL}};b.merge(a.base.plugins,b)}(Air),function(a){function b(){try{document.documentElement.doScroll("left")}catch(a){return void setTimeout(b,1)}g()}function c(a){return 1==d?void a():void e.push(a)}var d=!1,e=[],f=a.base.plugins.beacon,g=(a.base.plugins,function(){f(document).off("readystatechange",h),f(document).off("DOMContentLoaded",g),f(window).off("load",g);for(var a;a=e.shift();)d||a();d=!0}),h=function(){(/loaded|complete/.test(document.readyState)||1==d)&&g()};f(document).on("readystatechange",h),f(document).on("DOMContentLoaded",g),f(window).on("load",g),document.documentElement.doScroll&&b(),a.base.attach("DOMReady",c)}(Air),function(a,b){function c(a,b){var c=1;this.loadJS=function(){if(/\bArray\b/.test(Object.prototype.toString.call(a))){c=a.length;for(var d=c-1;d>=0;d--)e(a[d],function(){--c||b()})}else e(a,b)}}function d(){function a(){b.currentJs||(b.currentJs=b.shift(),b.currentJs&&b.currentJs.loadJS())}var b=[];b.currentJs=null,this.loadJS=function(d,e){var f=function(){b.currentJs=null,e&&e(),a()};return b.push(new c(d,f)),a(),this}}function e(a,c){var d,e=document.getElementsByTagName("head")[0],f=document.createElement("script"),g=!1,h=b.base.plugins.beacon,i=function(){g=!0,h(f).off("load"),h(f).off("readystatechange"),i=function(){},c&&c()},j=function(){/loaded|complete/.test(f.readyState)&&0==g&&i()};f.async=!0,f.setAttribute("type","text/javascript"),f.src=a,h(f).on("load",i),h(f).on("readystatechange",j),h(f).on("error",i);for(var k=document.getElementsByTagName("script"),l=0,m=k.length;!d&&m>l;l++)d=a==k[l].getAttribute("src");d||e.appendChild(f)}function f(a,b){var c=new d;return c.loadJS(a,b),c}b.base.attach(a,f)}("loadJS",Air),function(a){function b(b,d){"use strict";function e(){var e=i.toLowerCase(),f=h.toLowerCase(),g=a.base,j=g.plugins.beacon,k=g.plugins.NS,l=g.plugins.NS(h.toLowerCase(),g)[e],m=d(g.Require,g.run);l?"function"==typeof m?k(f,g)[e]=g.plugins.merge(m,l):g.plugins.merge(l,m):k(f,g)[e]=m,c[b.toLowerCase()]=!0,j.on(a.base.Require.Event.LOADED,{moduleName:b})}var f=a.base.plugins;f.beacon.on(a.base.Require.Event.REQUIREING,{moduleName:b});var g=b.match(/(^.*)\.(\w*)$/),h=g[1],i=g[2],j=d.toString().replace(/(?!['"])\/\*[\w\W]*?\*\//gim,"");j=j.replace(/(['"])[\w\W]*?\1|((['"])[\w\W]*?)\/\/[\w\W]*?\2|\/\/[\w\W]*?(\r|\n|$)/g,function(a,b){return b?a:""});var k=j.replace(/^function\s*?\(\s*?([^,\)]+)[\w\W]*$/,function(a,b){return b}).replace(j,""),l=k&&new RegExp("\\b"+k+"\\s*\\(([^\\)]+)\\)","gm"),m=[];l&&j.replace(l,function(b,d){var e=d.replace(/['"]/g,""),f=e.toLowerCase();c[f]||(m[f]=m.push(f)-1),a.base.Require(e)});var n=new String(b);m.length&&beacon(n).on(a.base.Require.Event.LOADED,function(b,c){var d=c.moduleName.toLowerCase();m.hasOwnProperty(d)&&(delete m[d],m.splice(m[d],1)),m.length<=0&&(beacon(n).off(a.base.Require.Event.LOADED),e())}),m.length||e()}var c={};a.base.Module=b}(Air),function(a){function b(a){if(a)return g.moduleLoaded[a];for(var b=0,c=g.requireQueue.length;c>b;b++){var d=g.requireQueue[b];if(!g.moduleLoaded[d])return!1}return!0}function c(){d.on(f.COMPLETE),d(document).on("readystatechange"),c=function(){d.on(f.COMPLETE)}}var d=a.base.plugins.beacon,e=d.createEvent,f={COMPLETE:e("require_complete"),LOADED:e("require_loaded"),REQUIREING:e("require_requireing")},g={requiring:{},required:{},moduleLoaded:{},requireQueue:[]};d(g).on(f.REQUIREING,function(a,b){var c=b.moduleName.toLowerCase();g.requireQueue[c]||g.requireQueue.push(c),g.required[c]=!0});var h=function(d,e){function f(b){var c=b.match(/(^.*)(\.\w*)$/),d=(c[1],c[2],a.base.CDNTimestamp||"");return d=d&&"?"+d,a.base.baseURL+b.replace(/\./gi,"/")+".js"+d}function h(d){i(d)||(g.requiring[d]=!0,a.base.plugins.loadJS(e,function(){if(!g.required[d])throw new Error("module ["+d+"] is undefined! @"+e);b()&&c()}))}function i(a){return g.required[a]||g.requiring[a]||g.moduleLoaded[a]}var j=d;return d=d.toLowerCase(),g.required[d]||g.requiring[d]||g.moduleLoaded[d]?a.base.plugins.NS(d,a.base):(e=e||f(j),d=d.toLowerCase(),g.requireQueue[d]=!0,g.requireQueue.push(d),h(d),a.base.plugins.NS(d,a.base))};d.on(f.LOADED,function(a,d){var e=d.moduleName.toLowerCase();g.required[e]=!0,g.moduleLoaded[e]=!0,b()&&c()}),h.Event=f,h.isRequireComplete=b,a.base.Require=h}(Air),function(a){function b(){for(;function(){var a=c.shift();return a&&a(),c.length}(););}var c=[],d=a.base.plugins.beacon,e=a.base.Require.Event;d.on(e.COMPLETE,b);var f=function(){function f(){for(var b=0;b<h.length;b++){var c=h[b];if(!h[c]&&!a.base.Require.isRequireComplete(c))return!1}return!0}var g,h=[];this.runNow&&d.on(e.LOADED,function(a,b){var c=b.moduleName.toLowerCase();h[c]=!0,beacon.utility.arrayIndexOf(h,c)>=0&&f()&&g&&g()}),this.run=function(d){g=d,this.runNow?f()&&d():(c.push(d),a.base.Require.isRequireComplete()&&b())},this.require=function(b,c){if(a.base.Require(b,c),b=b.toLowerCase(),h.push(b),!c){var d=b.match(/(^.*)\.(\w*)$/),e=d[1],f=d[2];a.base.plugins.NS(e,a.base)[f]}var g=a.base.plugins.NS(b,a.base);return g}},g=function(a,b){"use strict";var c=g;if(!(this instanceof c))return new c(a,b,arguments);var d=[].slice.call(arguments[2]).slice(2),e=this;e.runNow=b,f.call(e);var h=a.toString().replace(/(?!['"])\/\*[\w\W]*?\*\//gim,"");h=h.replace(/(['"])[\w\W]*?\1|((['"])[\w\W]*?)\/\/[\w\W]*?\2|\/\/[\w\W]*?(\r|\n|$)/g,function(a,b){return b?a:""});var i=h.replace(/^function\s*?\(\s*?([^,\)]+)[\w\W]*$/,function(a,b){return b}).replace(h,""),j=i&&new RegExp("\\b"+i+"\\s*\\(([^\\)]+)\\)","gm");j&&h.replace(j,function(a,b){var c=b.replace(/['"]/g,"");e.require(c)}),e.run(function(){var b=[e.require].concat(d);a.apply(this,b)})};a.base.attach("run",g)}(Air),function(a){var b=a.base.plugins,c={run:b.run,iRun:function(a){b.run(a,!0)},loadJS:b.loadJS,Module:a.base.Module,merge:a.base.merge,NS:b.NS,Enum:a.base.Enum,domReady:b.DOMReady,moduleURL:b.setBaseURL,setCDNTimestamp:a.base.setCDNTimestamp};a.base.init(c)}(Air),Object.observe||function(a,b,c,d){"use strict";var e,f,g=["add","update","delete","reconfigure","setPrototype","preventExtensions"],h=function(){var b=a.getOwnPropertyNames;try{h()}catch(c){var d=(b(j).join(" ")+" ").replace(/prototype |length |name /g,"").slice(0,-1).split(" ");d.length&&(b=function(b){var c=a.getOwnPropertyNames(b);if("function"==typeof b)for(var e,f=0;f<d.length;)(e=j(c,d[f++]))>-1&&c.splice(e,1);return c})}return b},i=b.isArray||function(a){return function(b){return"[object Array]"===a.call(b)}}(a.prototype.toString),j=b.prototype.indexOf?b.indexOf||function(a,c,d){return b.prototype.indexOf.call(a,c,d)}:function(a,b,c){for(var d=c||0;d<a.length;d++)if(a[d]===b)return d;return-1},k=c.Map!==d&&Map.prototype.forEach?function(){return new Map}:function(){var a=[],b=[];return{size:0,has:function(b){return j(a,b)>-1},get:function(c){return b[j(a,c)]},set:function(c,d){var e=j(a,c);-1===e?(a.push(c),b.push(d),this.size++):b[e]=d},"delete":function(c){var d=j(a,c);d>-1&&(a.splice(d,1),b.splice(d,1),this.size--)},forEach:function(c){for(var d=0;d<a.length;d++)c.call(arguments[1],b[d],a[d],this)}}},l=a.getOwnPropertyNames?h():function(b){var c,d,e=[];if("hasOwnProperty"in b)for(c in b)b.hasOwnProperty(c)&&e.push(c);else{d=a.hasOwnProperty;for(c in b)d.call(b,c)&&e.push(c)}return i(b)&&e.push("length"),e},m=a.getPrototypeOf,n=a.defineProperties&&a.getOwnPropertyDescriptor,o=c.requestAnimationFrame||c.webkitRequestAnimationFrame||function(){var a=+new Date,b=a;return function(c){return setTimeout(function(){c((b=+new Date)-a)},17)}}(),p=function(a,b,c){var d=e.get(a);d?(r(d,a),v(a,d,b,c)):(d=q(a),v(a,d,b,c),1===e.size&&o(s))},q=function(b,c){var d,f=l(b),g=[],h=0,c={handlers:k(),frozen:a.isFrozen?a.isFrozen(b):!1,extensible:a.isExtensible?a.isExtensible(b):!0,proto:m&&m(b),properties:f,values:g,notifier:u(b,c)};if(n)for(d=c.descriptors=[];h<f.length;)d[h]=n(b,f[h]),g[h]=b[f[h++]];else for(;h<f.length;)g[h]=b[f[h++]];return e.set(b,c),c},r=function(){var b=n?function(a,b,c,d,e){var f=b.properties[c],g=a[f],h=b.values[c],i=b.descriptors[c];"value"in e&&(h===g?0===h&&1/h!==1/g:h===h||g===g)&&(w(a,b,{name:f,type:"update",object:a,oldValue:h},d),b.values[c]=g),!i.configurable||e.configurable&&e.writable===i.writable&&e.enumerable===i.enumerable&&e.get===i.get&&e.set===i.set||(w(a,b,{name:f,type:"reconfigure",object:a,oldValue:h},d),b.descriptors[c]=e)}:function(a,b,c,d){var e=b.properties[c],f=a[e],g=b.values[c];(g===f?0===g&&1/g!==1/f:g===g||f===f)&&(w(a,b,{name:e,type:"update",object:a,oldValue:g},d),b.values[c]=f)},c=n?function(a,c,d,e,f){for(var g,h=c.length;d&&h--;)null!==c[h]&&(g=n(a,c[h]),d--,g?b(a,e,h,f,g):(w(a,e,{name:c[h],type:"delete",object:a,oldValue:e.values[h]},f),e.properties.splice(h,1),e.values.splice(h,1),e.descriptors.splice(h,1)))}:function(a,b,c,d,e){for(var f=b.length;c&&f--;)null!==b[f]&&(w(a,d,{name:b[f],type:"delete",object:a,oldValue:d.values[f]},e),d.properties.splice(f,1),d.values.splice(f,1),c--)};return function(d,e,f){if(d.handlers.size&&!d.frozen){var g,h,i,k,o,p,q,r,s=d.values,t=d.descriptors,u=0;if(d.extensible)if(g=d.properties.slice(),h=g.length,i=l(e),t){for(;u<i.length;)o=i[u++],k=j(g,o),r=n(e,o),-1===k?(w(e,d,{name:o,type:"add",object:e},f),d.properties.push(o),s.push(e[o]),t.push(r)):(g[k]=null,h--,b(e,d,k,f,r));c(e,g,h,d,f),a.isExtensible(e)||(d.extensible=!1,w(e,d,{type:"preventExtensions",object:e},f),d.frozen=a.isFrozen(e))}else{for(;u<i.length;)o=i[u++],k=j(g,o),p=e[o],-1===k?(w(e,d,{name:o,type:"add",object:e},f),d.properties.push(o),s.push(p)):(g[k]=null,h--,b(e,d,k,f));c(e,g,h,d,f)}else if(!d.frozen){for(;u<g.length;u++)o=g[u],b(e,d,u,f,n(e,o));a.isFrozen(e)&&(d.frozen=!0)}m&&(q=m(e),q!==d.proto&&(w(e,d,{type:"setPrototype",name:"__proto__",object:e,oldValue:d.proto}),d.proto=q))}}}(),s=function(){e.size&&(e.forEach(r),f.forEach(t),o(s))},t=function(a,b){var c=a.changeRecords;c.length&&(a.changeRecords=[],b(c))},u=function(a,b){return arguments.length<2&&(b=e.get(a)),b&&b.notifier||{notify:function(b){b.type;var c=e.get(a);if(c){var d,f={object:a};for(d in b)"object"!==d&&(f[d]=b[d]);w(a,c,f)}},performChange:function(b,c){if("string"!=typeof b)throw new TypeError("Invalid non-string changeType");if("function"!=typeof c)throw new TypeError("Cannot perform non-function");var f,g,h=e.get(a),i=arguments[2],j=i===d?c():c.call(i);if(h&&r(h,a,b),h&&j&&"object"==typeof j){g={object:a,type:b};for(f in j)"object"!==f&&"type"!==f&&(g[f]=j[f]);w(a,h,g)}}}},v=function(a,b,c,d){var e=f.get(c);e||f.set(c,e={observed:k(),changeRecords:[]}),e.observed.set(a,{acceptList:d.slice(),data:b}),b.handlers.set(c,e)},w=function(a,b,c,d){b.handlers.forEach(function(b){var e=b.observed.get(a).acceptList;("string"!=typeof d||-1===j(e,d))&&j(e,c.type)>-1&&b.changeRecords.push(c)})};e=k(),f=k(),a.observe=function(b,c,e){if(!b||"object"!=typeof b&&"function"!=typeof b)throw new TypeError("Object.observe cannot observe non-object");if("function"!=typeof c)throw new TypeError("Object.observe cannot deliver to non-function");if(a.isFrozen&&a.isFrozen(c))throw new TypeError("Object.observe cannot deliver to a frozen function object");if(e===d)e=g;else if(!e||"object"!=typeof e)throw new TypeError("Third argument to Object.observe must be an array of strings.");return p(b,c,e),b},a.unobserve=function(a,b){if(null===a||"object"!=typeof a&&"function"!=typeof a)throw new TypeError("Object.unobserve cannot unobserve non-object");if("function"!=typeof b)throw new TypeError("Object.unobserve cannot deliver to non-function");var c,d=f.get(b);return d&&(c=d.observed.get(a))&&(d.observed.forEach(function(a,b){r(a.data,b)}),o(function(){t(d,b)}),1===d.observed.size&&d.observed.has(a)?f["delete"](b):d.observed["delete"](a),1===c.data.handlers.size?e["delete"](a):c.data.handlers["delete"](b)),a},a.getNotifier=function(b){if(null===b||"object"!=typeof b&&"function"!=typeof b)throw new TypeError("Object.getNotifier cannot getNotifier non-object");return a.isFrozen&&a.isFrozen(b)?null:u(b)},a.deliverChangeRecords=function(a){if("function"!=typeof a)throw new TypeError("Object.deliverChangeRecords cannot deliver to non-function");var b=f.get(a);b&&(b.observed.forEach(function(a,b){r(a.data,b)}),t(b,a))}}(Object,Array,this),Air.Module("B.util.middleware",function(){function a(a,b){a&&b&&(d[a]=d[a]||[],d[a].push(b))}function b(a,b){if(a&&b){var c=d[a]||[],e=c.indexOf(b);-1!==e&&c.splice(e,1)}}function c(a,b,c){var e=d[a],f=e&&e.length;if(c=c||function(){},f){var g=0,h=function(){var a=e[g];return f>g&&a?void a(b,function(){g++,h.apply(h,arguments)}):void c.apply(c,arguments)};h()}else c()}var d={};return{add:a,run:c,remove:b}}),Air.Module("B.util.node",function(){var a=function(a){var b={hasAttribute:function(b){return a.attributes.getNamedItem(b)}};return b};return a.type={TEXT:3,HTML:1,ATTR:2},a}),Air.Module("B.util.util",function(){var a={isEmpty:function(a){if(null==a)return!0;var b=beacon.utility.isType(a,"Object"),c=beacon.utility.isType(a,"Array");if(!b&&!c)return!1;for(var d in a)if(a.hasOwnProperty(d))return!1;return!0},enums:function(a){for(var b={},c=a.length-1;c>=0;c--)b[a[c]]=a[c];return b},getData:function(a,b){for(var c=a.split("."),d=b||window||{},b=d,e=0,f=c.length;f>e;e++){if(!d||void 0===d[c[e]])return;d=d[c[e]]}return d}};return a}),Air.Module("B.data.memCache",function(){function a(a,b,e){if(a&&(c[a]=b,e&&"number"==typeof e.expiredSecond)){var f=new Date;f.setSeconds(f.getSeconds()+e.expiredSecond),d[a]=f}}function b(a){if(a){var b=c[a],e=d[a];if(e){var f=new Date;if(f.getTime()>e.getTime())return delete c[a],void delete d[a]}return b}}var c={},d={};return{get:b,set:a}}),Air.Module("B.data.storage",function(a){var b=a("B.data.memCache"),c=b.set,d=function(a,c){var d=b.get(a);c&&c(d)};return{get:d,set:c}}),Air.Module("B.event.events",function(){var a={DATA_CHANGE:beacon.createEvent("data change"),RUN_COMPLETE:beacon.createEvent("run complete"),URL_CHANGE:beacon.createEvent("url change"),PAGE404:beacon.createEvent("")};return a}),Air.Module("B.directive.event",function(require){var node=require("B.util.node"),EVENTS=require("B.event.events"),attribute="b-event",reg=/(\((.*?)\))/,api=function(target,$scope){function getParentScope(a){return a.parent?getParentScope(a.parent):a}function bind(cmd,eventIndex){var eventName=cmd.match(/^\s*(\w+)\s+/)[1];beacon(target).on(eventName,function(e){var cmd=target.getAttribute(attribute),cmdList=cmd.split(";"),handleStr=cmdList[eventIndex].replace(eventName,""),eventHandleName=handleStr.replace(reg,"").replace(/\s/g,""),eventParam=handleStr.match(reg)[2],params=eval("["+eventParam+"]");params.unshift(e),this.$index=$scope.$index;var scope=getParentScope($scope),eventHandle=$scope.$event&&$scope.$event[eventHandleName]||scope.$event&&scope.$event[eventHandleName];eventHandle&&eventHandle.apply(this,params),beacon(scope).on(EVENTS.DATA_CHANGE,scope)})}if(node(target).hasAttribute(attribute))for(var cmd=target.getAttribute(attribute),cmdList=cmd.split(";"),i=0;i<cmdList.length;i++)bind(cmdList[i],i)};return api}),Air.Module("B.directive.show",function(a){function b(a,b){function c(){var c=a.getAttribute(k),d=j.getData(c,b);d=j.isEmpty(d)?!1:d,d?h(a,!0):h(a)}var d=a.getAttribute(k);b.listenDataChange(d,c)}function c(a,b,c){return a.bData=a.bData||{},a.bData[b]}function d(a,b,c){return a.bData=a.bData||{},a.bData[b]=c,c}function e(a,b){var c=a.style.display;return c||(c=window.getComputedStyle?window.getComputedStyle(a,null)[b]:a.currentStyle[b]),c}function f(a){var b=document.body.appendChild(document.createElement(a)),c=e(b,"display");return document.body.removeChild(b),c}function g(a){var b=m[a];return b||(b=f(a),m[a]=b),b}function h(a,b){var e,f;a&&a.style&&(f=c(a,"olddisplay"),e=a.style.display,b?(f||"none"!==e||(a.style.display="",e=""),""===e&&(f=d(a,"olddisplay",g(a.nodeName)))):e&&"none"!==e&&d(a,"olddisplay",e),b&&"none"!==e&&""!==e||(a.style.display=b?f||"":"none"))}var i=a("B.util.node"),j=(a("B.event.events"),a("B.util.util")),k="b-show",l=function(a,c){var d=i(a).hasAttribute(k);d&&b(a,c)},m={};return l}),Air.Module("B.directive.property",function(a){function b(a,b){for(var e=a.getAttribute(h),f=d(e),g=0;g<f.length;g++){var i=f[g];c(i,a,b)}}function c(a,b,c){beacon(c).on(f.DATA_CHANGE,function(){var d=g.getData(a.dataPath,c);b[a.name]=d})}function d(a){var b=/(\w+)\s*:\s*(\S+?\b)/g,c=[];return a.replace(b,function(a,b,d){var e={name:b,dataPath:d};c.push(e)}),c}var e=a("B.util.node"),f=a("B.event.events"),g=a("B.util.util"),h="b-property",i=function(a,c){var d=e(a).hasAttribute(h);d&&b(a,c)};return i}),Air.Module("B.directive.model",function(a){var b=a("B.util.node"),c=a("B.util.util"),d=(a("B.event.events"),"b-model"),e=function(a,e){function f(a){var b=this;new Function("$scope","target","$scope."+h+"= target.value")(e,b);var c="input"===a.type?"change":"input";beacon(b).off(c,f)}function g(){var b=c.getData(h,e);if(a.value!==b){var d=c.isEmpty(b)?"":b;a.value!==b&&(a.defaultValue=d,"file"!==a.type&&(a.value=d))}}if(b(a).hasAttribute(d)){var h=a.getAttribute(d).replace(/{{|}}/gi,"");beacon(a).on("input",f),beacon(a).on("change",f),e.listenDataChange(h,g)}};return e}),Air.Module("B.scope.Scope",function(a){var b=(a("B.event.events"),a("B.util.util"),function(a){this.parent=a}),c={};c.listenDataChange=function(a,b){for(var c=this,d="",e=a.split(".")||[],f=0;f<e.length;f++){var g=e.shift(),h=d?beacon.utility.NS(d,c):c;Object.defineProperty(h,g,b.call(h,repeater,currentScopeIndex)),d=g?d+"."+g:g}};var d=function(a){return b.prototype=a||c,b.prototype.constructor=b,new b(a)};return d}),Air.Module("B.scope.ScopeTreeManager",function(a){function b(a){var b=[],d={},e=function(){return{scope:null,pn:null,name:null}},f=function(a){return a?b[a]:null},g=function(a){var c=b[0]||e();beacon.utility.merge(c.scope,a),b[0]=c},h=function(a,g){var h=f(a),i=e(),j=b.push(i)-1;return i.scope=new c(h),i.pn=a,i.name=g,d[g]=i,j},i=function(a){return d[a]};g(a);var j={addScope:h,getScope:f,getScopeByName:i};return j}var c=a("B.scope.Scope");return b}),Air.Module("B.directive.repeat",function(a){function b(a,b){var f=d(a);e(a.cachedNodes);var g=i(a),j=c(g,b),k=h(g,b,j,f);return k}function c(a,b){var c=a.getAttribute(n),d=c.replace(/\S+\s+in\s+(\S+)/gi,"$1"),e=c.match(/(\S+)\s+in\s+(\S+)/i)[1];a.repeatDataPath=d;var f=r.getData(d,b);return{data:f,itemName:e,dataPath:d}}function d(a){if(a.placeholder)return a.placeholder;var b=document.createComment("repeat placeholder "+a.getAttribute(n));return a.parentNode.insertBefore(b,a),a.placeholder=b,b}function e(a){a=a||[];for(var b,c=0,d=a.length;d>c;c++)b=a[c],b.parentNode&&b.parentNode.removeChild(b),f(b)}function f(a){}function g(a,b){a.cachedNodes=a.cachedNodes||[],a.cachedNodes.push(b)}function h(a,b,c,d){var e=[],f=c.data,h=c.itemName,i=document.createDocumentFragment();if(beacon.utility.isType(f,"Array")){for(var k,l=0,m=f.length;m>l;l++){var k=f[l],o=a.cloneNode(!0),q=new p(b);q.$index=o.$index=l,q[h]=k,o.removeAttribute(n),i.appendChild(o),g(a,o),e.push({node:o,$scope:q})}d.parentNode.insertBefore(i,d),j(d,a)}return e}function i(a){return a.parentNode&&a.parentNode.removeChild(a),a}function j(a,b){"option"==b.nodeName.toLowerCase()&&setTimeout(function(){a.parentNode.value=a.parentNode.defaultValue},0)}function k(a,b){var c=o(a).hasAttribute(n),d=!a.repeatDataPath;a.cachedNodes=a.cachedNodes||[];var e;return a.repeatDataPath&&(e=r.getData(a.repeatDataPath,b).length!==a.cachedNodes.length),c&&d||e}function l(a,b,c){var d=a&&beacon.utility.isType(a,"Array"),e=a&&beacon.utility.isType(a,"Object");(e||d)&&Object.observe(a,function(a){for(var d=0;d<a.length;d++){var e=a[d].type,f="update"===e&&b.match(new RegExp("."+a[d].name+"$"));if("add"==e||f){var g=a[d],h=g.object[g.name];l(h,b,c)}("length"===a[d].name||f)&&c()}})}function m(a,b,d){beacon(b).once(q.RUN_COMPLETE,function(){var e=c(a,b);d();for(var f=e.dataPath.split("."),g="",h=0;h<f.length;h++){g=g?g+"."+f[h]:f[h];var i=r.getData(g,b);l(i,e.dataPath,d)}}),Object.observe(b,function(e){for(var f,g=c(a,b),h=0;h<e.length;h++){f=e[h];var i=f.type;if("add"===i||"update"===i&&f.oldValue!==f.object[f.name]){var j=e[h],k=j.object[j.name];l(k,g.dataPath,d)}f.name===g.dataPath.split(".")[0]&&d()}})}var n="b-repeat",o=a("B.util.node"),p=a("B.scope.Scope"),q=a("B.event.events"),r=a("B.util.util");return{init:b,needRepeat:k,listenDataChange:m}}),Air.Module("B.scope.scopeManager",function(a){function c(a,b){var c=w.getScopeByName(a);return c||(l(template,a),c=w.getScope(0)),c}function d(a){return a==Type}function e(a){var b=d(a);return b&&"VIEW"==a.nodeName.toUpperCase()}function f(a){var b=d(a);return b&&a.hasAttribute("b-repeat")}function g(a){return a.nodeValue.match(/{{.+?}}/g)||[]}function h(a,b,c){for(var d=scopeManager.getScope(c),e="",f=b.split(".")||[],g=0;g<f.length;g++){var h=f.shift(),i=e?beacon.utility.NS(e,d):d;h&&Object.defineProperty(i,h,n.call(i,a)),e=h?e+"."+h:h}}function i(a,b){for(var c=g(a.nodeValue),d=(scopeManager.getScope(b),0);d<c.length;d++){var e=c[d];h(a,e,b)}}function j(a,c){if("view"===node.tagName.toLowerCase()){var d=node.getAttribute("b-scope-key"),e=node.getAttribute("name"),f=d||e,g=w.getScopeByName(f);if(!g){var h=scopeManager.addScope(currentScopeIndex,f);c=w.getScope(h)}if(c=g,d){var i=v.get("controllerMap")||{},j=i[e];j&&setTimeout(function(){b.run(e,j)},0)}}return $scope}function k(a,b){var c=scopeManager.getScope(b);c=j(a,c),q(a,c),r(a,c),s(a,c),t(a,c);for(var d=[].concat.apply([],a.attributes),e=0;e<d.length;e++){d[e];i(a,b)}}function l(a,b,c){if(a){switch(c=c||0,e(a)?c=scopeManager.addScope(c,b):f(a)&&(a=m(a,c)),a.nextSibling&&x.push(a),a.noteType){case u.type.HTML:a=k(a,c);break;case u.type.TEXT:case u.type.ATTR:i(a,c)}var d=a.firstChild||a.nextSibling||x.pop().nextSibling,g=e(d)?scopeManager.getScope(c).pn:c;return l(d,b,g)}}function m(a,b){var c=new Repeater(a,b),d=c.updateUI();return d}function n(a){var b={get:function(){return this.value},set:function(b){var c=this.value!==b,d=beacon.utility.isType(b,"Array")||beacon.utility.isType(b,"Object");c&&d?beacon.utility.merge(this.value,b):(this.value=b,a.nodeValue=b)}};return b}var o={},p=a("B.scope.ScopeTreeManager"),q=a("B.directive.model"),r=a("B.directive.event"),s=a("B.directive.show"),t=a("B.directive.property"),u=(a("B.util.util"),a("B.util.node")),v=a("B.data.memCache"),w=new p(o),x=[];return{parseScope:c,getScope:w.getScope,setRoot:setRoot}}),Air.Module("B.network.HTTP",function(){function a(){var a=new XMLHttpRequest,c=this;a.onreadystatechange=function(){a.readyState===b.complete&&(a.status>=200&&a.status<300||304==a.status||0==a.status&&c.requestURL.match(/^file:/)?c.successCallBack&&c.successCallBack(a):c.errorCallBack&&c.errorCallBack(a));
},this.xhr=a}var b={unInit:0,opend:1,sended:2,receiving:3,complete:4};return a.prototype={request:function(a){this.requestURL=a.url,this.successCallBack=a.successCallBack,this.errorCallBack=a.errorCallBack,this.xhr.open(a.method,a.url,!0);for(var b in a.header)this.xhr.setRequestHeader(b,a.header[b]);this.xhr.send(a.data)},get:function(a,b){b=b||{},this.request({method:"GET",url:a,successCallBack:b.successCallBack,errorCallBack:b.errorCallBack})},abort:function(){this.xhr.abort()}},a}),Air.Module("B.service.Service",function(a){function b(a,b,h){a=a||{};var k=a.header||{};k["Content-Type"]="application/json;charset=utf-8";var l=this,m=new e;this.noTriggerEvent=!1;var n={SUCCESS:beacon.createEvent("service response success"),ERROR:beacon.createEvent("service response error")};this.EVENTS=n,this.on=function(a,b){beacon(l).on(a,b)},this.off=function(a,b){beacon(l).off(a,b)},this.getConfig=function(){var b=beacon.utility.merge({},a.header);return beacon.utility.merge({},a,{header:b})},this.query=function(e,o){function p(){h.onQuery&&h.onQuery(),c(A,function(){C=i[y],C?C.push({httpSuccessCallback:s,httpErrorCallback:t}):(C=i[y]=[],A.successCallBack=s,A.errorCallBack=t,m.request(A),q())})}function q(){z=setTimeout(function(){m.abort()},1e3*w)}function r(){clearTimeout(z)}function s(c,e){r(),c=c||{};var i="",k=null,p=!1;if(h.onComplete&&h.onComplete(),e||4!==c.readyState)k=c;else{i=c.responseText;try{k=JSON.parse(i)}catch(q){p=!0}}p?d({xhr:m.xhr,data:k,requestParam:A,errorCode:j.parse},function(a){if(o.errorCallBack&&o.errorCallBack(j.parse,i),beacon(l).on(n.ERROR,{error:j.parse,response:i}),beacon(b).on(f.DATA_CHANGE),!e){var a=!0;u(a,c)}v()}):d({xhr:m.xhr,data:k,requestParam:A},function(d){if(d){if(o.errorCallBack&&o.errorCallBack(j.business,k),beacon(l).on(n.ERROR,{error:j.business,response:k}),!e){var d=!0;u(d,c)}}else{var h=!1,m=function(){if(a.expiredSecond&&g.set(y,i,{expiredSecond:a.expiredSecond}),o.successCallBack&&o.successCallBack(k),beacon(l).on(n.SUCCESS,k),!e){var b=!1;u(b,k)}};o.noCache?m():h=B(m)}beacon(b).on(f.DATA_CHANGE),v()})}function t(a,c){if(r(),h.onComplete&&h.onComplete(),v(),l.noTriggerEvent)return void(l.noTriggerEvent=!1);var e=a.status?j.network:j.timeout;d({errorCode:e,xhr:a,requestParam:A},function(b){if(o.errorCallBack&&o.errorCallBack(e,b),beacon(l).on(n.ERROR,{error:e,response:b}),!c){var d=!0;u(d,a)}}),beacon(b).on(f.DATA_CHANGE)}function u(a,b){var c=([].slice.call(arguments,1),!0);if(C&&C.length){for(var d;d=C.shift();)d&&(a?d.httpErrorCallback&&d.httpErrorCallback.call(l,b,c):d.httpSuccessCallback&&d.httpSuccessCallback.call(l,b,c));v()}}function v(){C&&!C.length&&delete i[y]}o=o||{};var w=beacon.isType(a.timeout,"Number")?a.timeout:30,x=a.protocol+"://"+a.host+a.path,y=x+JSON.stringify(e),z=null,A={url:x,method:a.method,header:k,data:JSON.stringify(e),serviceName:a.serviceName},B=function(a){g.get(y,function(c){try{var d=JSON.parse(c);if(d){var e=!0;return void setTimeout(function(){o.successCallBack&&o.successCallBack(d,e),beacon(l).on(n.SUCCESS,d),beacon(b).on(f.DATA_CHANGE)},0)}}catch(g){}a&&a()})},C=i[y];o.noCache||C?p():B(p)},this.abort=function(a){l.noTriggerEvent=a,m.abort()}}function c(a,b){var c="beforeQuery";h.run(c,a,b)}function d(a,b){var c="afterQuery";h.run(c,a,b)}var e=a("B.network.HTTP"),f=a("B.event.events"),g=a("B.data.storage"),h=a("B.util.middleware"),i={},j={parse:1,timeout:2,network:3,business:4};return b}),Air.Module("B.service.serviceFactory",function(a){function b(a,b){a&&(g[a]=b)}function c(a){return g[a]||{}}function d(a,b){if(!a)throw new Error("serviceName is required");var d=beacon.utility.merge({},c(b.extend),b);h[a]=d}function e(a,b){var c=h[a];if(c){c.serviceName=a;var d=new i(c,b,{onQuery:function(){k.push(d)},onComplete:function(){var a=beacon.utility.arrayIndexOf(k,d);-1!==a&&k.splice(a,1)}});return d}throw new Error(a+" not found")}function f(){for(var a,b=k.concat([]),c=0,d=b.length;d>c;c++)a=b[c],a&&a.abort(!0)}var g=[],h=[],i=a("B.service.Service"),j=a("B.util.middleware"),k=[];return{setConfig:b,set:d,get:e,addMiddleware:j.add,removeMiddleware:j.remove,abortAll:f}}),Air.Module("B.router.router",function(){function a(a){var c=b(a.rule),d={rule:a.rule,viewName:a.viewName,sign:a.sign,reg:c.reg,params:c.params};h.push(d),h[a.viewName]=d}function b(a){var b=/:[\w-]+/gi,c=[],d=a.replace(b,function(a){return c.push(a.replace(":","")),"([\\w-]+)"}),e=new RegExp("^"+d+"/*$","i");return{reg:e,params:c}}function c(a){var b=h.length,c=0;for(c;b>c;c++){var e=h[c],f=d(e,a);if(f)return f}return null}function d(a,b){var c=null,d=b.match(a.reg);if(d){c={rule:a.rule,viewName:a.viewName,params:{}};var e=d.length,f=1;for(f;e>f;f++){var g=a.params[f-1];c.params[g]=d[f]}}return c}function e(a,b,c,d){var e=a.replace(/:(\w+)/gi,function(a,c){return b[c]||""});return location.origin||(location.origin=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")),e=(d?"":location.origin)+e+c}function f(a,b){b=b||{};var c=b.params||{},d=b.query||"",f=h[a],g=f&&f.rule||"",i=e(g,c,d,b.noOrigin);return i}function g(a){return h[a]||{}}var h=[],i={set:a,getMatchedRouter:c,getURLPathByViewName:f,get:g};return i}),Air.Module("B.view.View",function(a){function b(a){var b=document.createElement("div");return"undefined"==typeof DOMParser?b.innerHTML="X<div></div>"+a:b.innerHTML=a,b}function c(a,b){for(var c,d=0,e=a.length;e>d;d++)c=a[d],b.appendChild(c)}function d(a,b,c){setTimeout(function(){e(a,b)},0),c&&c()}function e(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=document.createElement("script"),f=d.src;d.parentNode&&d.parentNode.removeChild(d),f?Air.loadJS(f):(e.text=d.text,b.appendChild(e))}}function f(a,b){var c=a.getElementsByTagName(b);return c=[].concat.apply([],c)}function g(a,b,c,d,e){var g=f(d,a),h=i.parseScope(b+a,{childNodes:g});beacon(h).once(j.DATA_CHANGE,function(){e&&e(g)}),beacon(h).on(j.DATA_CHANGE)}function h(a,e,f){if(f=f||{},beacon.isType(e,"String")){var h=b(e);e=h.querySelector('view[name="'+a+'"]'),g("style",a,e,h,function(a){c(a,e)}),g("script",a,e,h,function(a){d(a,e,f.initCallback)})}var i={onShow:beacon.createEvent("view onShow"),onHide:beacon.createEvent("view onHide")};this.show=function(){e.setAttribute("active","true"),"undefined"==typeof DOMParser&&(e.style.borderBottom="1px solid transparent",setTimeout(function(){e.style.borderBottom="none"},0))},this.hide=function(){e.removeAttribute("active")},this.getDom=function(){return e},this.getViewName=function(){return a},this.events=i,this.parseSrc=function(){for(var a,b=e.querySelectorAll("[b-src]")||[],c=0,d=b.length;d>c;c++){a=b[c];var f=a.getAttribute("b-src");f&&a.setAttribute("src",f)}}}var i=a("B.scope.scopeManager"),j=a("B.event.events");return h}),Air.Module("B.view.viewManager",function(a){function b(a){G.setRoot(a),c();var b=location.pathname,d=D.getMatchedRouter(b);d?g(d.viewName,{replace:!0,init:!0,params:d.params,query:location.search}):q(),n()}function c(){for(var a=document.querySelectorAll("viewport"),b=0,c=a.length;c>b;b++){var d=a[b],g="true"===d.getAttribute("main"),h={dom:d,views:[]};J.push(h),g&&e(h),f(h)}}function d(a,b){M.dom.appendChild(b.getDom()),M.views[a]=b}function e(a){M=a}function f(a){for(var b=a.dom,c=b.children,d=0,e=c.length;e>d;d++){var f=c[d];if("view"===f.tagName.toLowerCase()){var g=f.getAttribute("name"),h=new C(g,f);a.views[g]=h,G.parseScope(g,h.getDom())}}}function g(a,b){var c="beforeGoTo",d={viewName:a},e=function(){var c=r(a);h(a)||(c?(u(),m(a,b),k(a,b),p(a)):(i(a),t(a,b)))};I.run(c,d,e)}function h(a){return-1!==beacon.utility.arrayIndexOf(K,a)}function i(a){var b=beacon.utility.arrayIndexOf(K,a);-1===b&&K.push(a)}function j(a){var b=beacon.utility.arrayIndexOf(K,a);-1!==b&&K.splice(b,1)}function k(a,b){b=b||{};var c=G.getScope(a);c.$request=c.$request||{},c.$request.params=b.params}function l(a,b){var c=D.getURLPathByViewName(a,{params:b.params,query:b.query});return c}function m(a,b){b=b||{};var c=location.href,d=l(a,b),e=b.replace;if(history.pushState&&history.replaceState){var f=e?history.replaceState:history.pushState;f&&f.call(history,{viewName:a,params:b.params},a,d)}else e?!b.init&&location.replace(d):location.href=d;var g="afterURLChange",h={from:c,to:d};I.run(g,h)}function n(){beacon(window).on("popstate",function(a){var b=a.state||{};if(u(),b.viewName){var c=r(b.viewName);if(c)k(b.viewName,b),p(b.viewName);else{var d=location.pathname,e=D.getMatchedRouter(d);e?g(e.viewName,{replace:!0,params:e.params,query:location.search}):q()}}})}function o(){window.history.back()}function p(a){var b=r(a);b?(b.parseSrc(),w(b)):q()}function q(){var a="viewNotFound";I.run(a)}function r(a){return M.views[a]}function s(a){var b=L.getDom(),c=b.querySelector('view[name="'+a+'"]');return c&&c.getAttribute("b-scope-key")||""}function t(a,b){function c(c){var e=c.responseText,f=new C(a,e,{initCallback:function(){A()}}),g=G.parseScope(a,f.getDom());k(a,b),d(a,f),u(),v(f),beacon(g).once(H.RUN_COMPLETE,function(){m(a,b),p(a),j(a)})}function e(){q()}z();var f=F.get("env"),g=D.get(a),h=g.sign||"",i=h?"_"+h:"",l=f.$templatePath+a+i+".html",n=new E;n.get(l,{successCallBack:c,errorCallBack:e})}function u(){N=B()}function v(a){L=a}function w(a){var b="";N&&(b=N.getViewName(),x(N,a)),v(a),L.show(),y(L,b)}function x(a,b){var c=a.getViewName();a&&a.hide(),beacon(a).on(a.events.onHide,{to:b});var d=G.getScope(c);beacon(d).on(H.DATA_CHANGE)}function y(a,b){var c=a.getViewName();beacon(a).on(a.events.onShow,{from:b});var d=G.getScope(c);beacon(d).on(H.DATA_CHANGE)}function z(){}function A(){}function B(){return L}var C=a("B.view.View"),D=a("B.router.router"),E=a("B.network.HTTP"),F=a("B.data.memCache"),G=a("B.scope.scopeManager"),H=a("B.event.events"),I=a("B.util.middleware"),J=[],K=[],L=null,M=null,N=null;return api={init:b,goTo:g,back:o,addMiddleware:I.add,removeMiddleware:I.remove,showLoading:z,hideLoading:A,getActive:B,getScopeKeyByViewName:s},api}),Air.Module("B.controller.run",function(a){var b=a("B.data.memCache"),c=function(c,d){var e=a("B.scope.scopeManager"),f=a("B.view.viewManager"),g=a("B.event.EVENTS"),h=f.getScopeKeyByViewName(c),i=e.getScope(h||c);if(h){var j=b.get("controllerMap");j||(j={},b.set("controllerMap",j)),j[c]=d,b.set("controllerMap",j)}Air.run(d,!1,i),Air.run(function(){beacon(i).on(g.DATA_CHANGE,i),beacon(i).on(g.RUN_COMPLETE)})};return c}),Air.Module("B.TDK.TDK",function(){function a(a){return document.title=a||document.title,document.title}function b(a){var b=d("description");return b.content=a||b.content,b.content}function c(a){var b=d("keywords");return b.content=a||b.content,b.content}function d(a){var b=f.querySelector("meta[name="+a+"]");return b=b||e(a)}function e(a){var b=document.createElement("meta");return b.setAttribute("name",a),f.appendChild(b),b}var f=document.head||document.getElementsByTagName("head")[0],g={setTitle:a,setDescription:b,setKeywords:c};return g}),Air.run(function(a){var b=a("B.view.viewManager"),c=a("B.router.router"),d=a("B.data.memCache"),e=a("B.controller.run"),f=a("B.service.serviceFactory");TDK=a("B.TDK.TDK"),void function(){var a="b",g={views:b,router:c,service:f,utility:null,init:function(a){a=a||{},d.set("env",a),Air.moduleURL(a.$moduleURL),b.init(a)},run:e,Module:Air.Module,TDK:TDK,bridge:{run:function(){},isHybrid:!1,isInApp:!1},ready:function(a){a="function"==typeof a?a:function(){},Air.domReady(function(){a()})}};window[a]=g}()});